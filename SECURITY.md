# Security Policy

## Supported Versions

現在サポートされているバージョン：

| Version | Supported          |
| ------- | ------------------ |
| 1.0.x   | :white_check_mark: |

## Reporting a Vulnerability

セキュリティ上の脆弱性を発見した場合は、以下の手順で報告してください：

1. **公開しない**: GitHubのIssueやその他の公開チャンネルで脆弱性を報告しないでください。

2. **メールで報告**: セキュリティ問題は以下のメールアドレスに直接報告してください：
   - security@cooper-app.example.com（実際のメールアドレスに置き換えてください）

3. **報告内容**: 以下の情報を含めてください：
   - 脆弱性の詳細な説明
   - 再現手順
   - 影響範囲
   - 可能であれば、修正案やパッチ

4. **対応期間**: 
   - 48時間以内に受領確認のメールを送信します
   - 7日以内に初期評価と対応計画をお知らせします
   - 重大な脆弱性の場合は、可能な限り迅速に修正をリリースします

## セキュリティベストプラクティス

このアプリケーションを使用する際は、以下のセキュリティベストプラクティスに従ってください：

### Firebase設定
- Firebase設定ファイル（`js/firebase-config.js`）は絶対に公開リポジトリにコミットしない
- Firebase Security Rulesを適切に設定し、ユーザーが自分のデータのみにアクセスできるようにする
- APIキーは環境変数または安全な設定管理システムで管理する
- Firestore Security Rulesでメール認証済みユーザーのみアクセスを許可

### 認証
- Google認証のみを使用し、カスタム認証システムは実装しない
- セッション管理はFirebase Authenticationに完全に依存する
- 認証トークンをローカルストレージに保存しない
- メール認証済みのGoogleアカウントのみデータアクセスを許可

### データ保護
- **クライアントサイド暗号化の実装**
  - AES-GCM 256ビット暗号化による機密情報の保護
  - 暗号化対象フィールド：電話番号、メール、LINE、SNS情報、住所、メモ、容姿の特徴
  - PBKDF2（100,000回）によるセキュアなキー導出
  - Web Crypto APIを使用したブラウザネイティブ暗号化
- **暗号化キー管理**
  - ユーザーごとに独立した暗号化キー
  - 定期的なキーローテーション機能
  - キーはIndexedDBに安全に保存
  - マスターキーからの派生キー生成
- 個人情報は暗号化された接続（HTTPS）でのみ送信する
- ユーザーデータのバックアップは暗号化して保存する
- 不要になったデータは確実に削除する

### XSS対策
- すべてのユーザー入力をサニタイゼーション
- `textContent`や`setAttribute`を使用した安全なDOM操作
- `innerHTML`の使用を避け、XSS攻撃を防止
- Content Security Policy (CSP) ヘッダーの実装

### アップデート
- Firebase SDKとその他の依存関係を定期的に更新する
- セキュリティパッチは可能な限り迅速に適用する
- 定期的なセキュリティ監査の実施

## 実装済みセキュリティ機能

### 暗号化システム
- **アルゴリズム**: AES-GCM 256ビット（認証付き暗号化）
- **キー導出**: PBKDF2（100,000回のイテレーション）
- **実装**: Web Crypto API（ブラウザネイティブ）
- **対象データ**: 
  - 📱 電話番号
  - 📧 メールアドレス
  - 💬 LINE ID
  - 🐦 Twitter/Instagram/Facebook
  - 🏠 居住地
  - 📝 メモ
  - 👤 容姿の特徴

### セキュリティ監査対応（2025年1月）
以下の脆弱性に対する修正を実装：
- ✅ **Firebase APIキーの適切な管理**
- ✅ **Firestore Security Rulesの実装**
- ✅ **個人情報の暗号化保存**
- ✅ **XSS脆弱性の修正**
- ✅ **暗号化キーローテーション機能**
- ✅ **セキュアなセッション管理**

### 継続的なセキュリティ改善
- 月次セキュリティレビュー
- 依存関係の脆弱性スキャン
- ペネトレーションテストの定期実施
- ユーザーフィードバックに基づくセキュリティ強化

## 責任ある開示

私たちは責任ある開示を支持しています。セキュリティ研究者の方々には、上記のガイドラインに従って脆弱性を報告していただくようお願いします。

## 謝辞

セキュリティの向上に貢献してくださった方々に感謝します。（貢献者のリストは、本人の同意を得た上で掲載します）